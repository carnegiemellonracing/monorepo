#include <unity.h>
#include <cn-cbor/cn-cbor.h>



void setUp(void){

}
void tearDown(void)
{
}

void test(){
    char bytes[] = {
0xA2,0x12,0x58,0x32,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x18,0x29,0x58,0xC8,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,
0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,
0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,
0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,
0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,
0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,
0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0x0,0xFC,0x86,0xFF,0xA2,0x12,0x58,0x32,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x18,0x29,0x58,0xC8,0x0
};

    static cn_cbor *msg;
    static cn_cbor_errback err;
    msg = cn_cbor_decode(bytes, sizeof(bytes), &err);
    TEST_ASSERT_NOT_EMPTY
    /* Signal 42 in the current signal vector is the VSM's error vec,
     * try to parse and validate */
    cn_cbor *signal = cn_cbor_mapget_int(msg, 41);
    TEST_ASSERT(signal == NULL || signal->type != CN_CBOR_BYTES);
    cn_cbor_free(msg);
}

int main(void) {
    UNITY_BEGIN();
    RUN_TEST(test);
    return UNITY_END();
}